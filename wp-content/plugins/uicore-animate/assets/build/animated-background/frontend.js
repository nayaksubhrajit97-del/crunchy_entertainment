(()=>{"use strict";class e{constructor({element:e,settings:t}){this.$element=e,this.settings=t,this.onInit()}getElementSettings(e){return this.settings[e]}onInit(){this.hasMouseStarted=!1,this.mouse={x:.5,y:.5,vx:0,vy:0},this.targetMouse={x:.5,y:.5},this.damping=.72,this.stiffness=.12,this.canvas=null,this.updateMousePosition=this.updateMousePosition.bind(this),this.initBackground()}resize(){const e=this.$element[0],{renderer:t,program:i}=e.animatedBackground;t.setSize(e.offsetWidth,e.offsetHeight),i.uniforms.uResolution.value=[e.offsetWidth,e.offsetHeight,e.offsetWidth/e.offsetHeight]}updateMousePosition(e){const t=this.$element[0].getBoundingClientRect(),i=(e.clientX-t.left)/t.width,s=(e.clientY-t.top)/t.height;if(!this.hasMouseStarted)return this.mouse.x=i,this.mouse.y=s,this.targetMouse.x=i,this.targetMouse.y=s,void(this.hasMouseStarted=!0);this.targetMouse.x=i,this.targetMouse.y=s}loop(e){const t=this.$element[0],{renderer:i,program:s,mesh:n}=t.animatedBackground;this.$element[0].animationId=requestAnimationFrame(this.loop.bind(this)),s.uniforms.uTime.value=.001*e;const o=this.targetMouse.x-this.mouse.x,a=this.targetMouse.y-this.mouse.y;this.mouse.vx+=o*this.stiffness,this.mouse.vy+=a*this.stiffness,this.mouse.vx*=this.damping,this.mouse.vy*=this.damping,this.mouse.x+=this.mouse.vx,this.mouse.y+=this.mouse.vy,s.uniforms.uMouse.value=[this.mouse.x,this.mouse.y],i.render({scene:n})}destroy(){const e=this.$element[0].animatedBackground;if(!e)return;const{gl:t,program:i,geometry:s,mesh:n}=e;this.$element[0].animationId&&cancelAnimationFrame(this.$element[0].animationId),this.$element[0].removeEventListener("mousemove",this.updateMousePosition),window.removeEventListener("resize",this.resize);try{n?.delete?.()}catch(e){}try{t.deleteProgram(i?.program)}catch(e){}try{t.deleteBuffer(s?.attributes?.position?.buffer)}catch(e){}try{t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT)}catch(e){}this.$element[0].animatedBackground=null}initBackground(){const e=this.getElementSettings("uiAnimateBgAnimation")||null;if(!e)return;const t=e.replace("ui-fluid-","").replace(/-([a-z])/g,(e=>e[1].toUpperCase())),i="uiAnimated_"+t.charAt(0).toUpperCase()+t.slice(1);if(this.createCanvas(e),"function"!=typeof window[i])return;this.$element[0].animatedBackground&&this.destroy();const s=this.getBGSettings();window[i](this.$element[0],this.canvas,s),this.$element[0].animatedBackground?.custom||(requestAnimationFrame(this.loop.bind(this)),window.addEventListener("resize",this.resize.bind(this)),this.resize(),s.mouseInteractive&&this.$element[0].addEventListener("mousemove",this.updateMousePosition))}createCanvas(e){let t=this.$element[0].querySelector(".ui-fluid-canvas");t&&(this.$element[0].removeChild(t),t=null);const i=e.startsWith("ui-fluid-animation-")&&"ui-fluid-animation-6"!==e;if(t=i?document.createElement("div"):document.createElement("canvas"),t.className=i?"ui-fluid-gradient-wrapper ui-fluid-canvas":"ui-fluid-canvas",this.$element[0].insertBefore(t,this.$element[0].firstChild),i){const e=document.createElement("div");e.className="ui-fluid-gradient",t.appendChild(e)}else t.style.position="absolute",t.style.inset="0",t.style.width="100%",t.style.height="100%",t.style.display="block";this.canvas=t}getBGColorSettings(){const e=getComputedStyle(this.canvas);return{colorArray:[e.getPropertyValue("--ui-fluid-1")||"#b96d04",e.getPropertyValue("--ui-fluid-2")||"#dd7301",e.getPropertyValue("--ui-fluid-3")||"#f7c632",e.getPropertyValue("--ui-fluid-4")||"#934b14"].map((e=>this.getResolvedRGB(e))),backgroundColor:this.getResolvedRGB(e.getPropertyValue("--ui-fluid-bg")||"#000000")}}getBGSettings(){var e,t,i,s,n,o,a,u;const r={...this.getBGColorSettings(),scale:Number(null!==(e=this.getElementSettings("uiAnimateScale"))&&void 0!==e?e:10),intensity:Number(null!==(t=this.getElementSettings("uiAnimateIntensity"))&&void 0!==t?t:50),speed:"yes"===this.getElementSettings("uiAnimateStatic")?0:Number(null!==(i=this.getElementSettings("uiAnimateSpeed"))&&void 0!==i?i:20),noise:Number(null!==(s=this.getElementSettings("uiAnimateNoise"))&&void 0!==s?s:20),angle:Number(null!==(n=this.getElementSettings("uiAnimateAngle"))&&void 0!==n?n:0),mouseInteractive:"yes"===this.getElementSettings("uiAnimateInteractive"),progress:Number(null!==(o=this.getElementSettings("uiAnimateProgress"))&&void 0!==o?o:10),texture:this.getElementSettings("uiAnimateTexture")||null,offsetX:Number(null!==(a=this.getElementSettings("uiAnimateOffsetX"))&&void 0!==a?a:0),offsetY:Number(null!==(u=this.getElementSettings("uiAnimateOffsetY"))&&void 0!==u?u:0)};return"liquid-image"===this.getElementSettings("uiAnimateBgAnimation")&&(r.mouseInteractive=!0),r}getResolvedRGB(e){const t=document.createElement("div");t.style.color=e,window.document.body.appendChild(t);const i=getComputedStyle(t).color;window.document.body.removeChild(t);const[s,n,o]=i.match(/\d+/g).map(Number);return[s/255,n/255,o/255]}}window.animatedBackgroundController=e,document.addEventListener("DOMContentLoaded",(()=>{document.querySelectorAll(".ui-animated-background").forEach((t=>{const i={};Array.from(t.attributes).forEach((e=>{if(e.name.startsWith("data-")){const t=e.name.replace("data-","").replace(/-([a-z])/g,(e=>e[1].toUpperCase())).replace("ui","uiAnimate");i[t]=e.value}})),new e({element:[t],settings:i})}))}))})();